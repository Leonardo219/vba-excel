Sub ImportarData()

Dim MyResultados As String  'donde guardo el nombre del libro de resultados
Dim MyInfo As String        'donde guardo el nombre del libro que voy a abrir
Dim InfoPath As String      'donde se guada la información de la ubicacion del libro de info
Dim rango() As Variant

Application.ScreenUpdating = False          'para que no se vea en pantalla la apertura del libro (tarda menos)

    MyResultados = ThisWorkbook.Name

    Workbooks.Open Filename:=("C:\Users\72764546\Downloads\Rep_Inbound.xlsx")
        
    MyInfo = ActiveWorkbook.Name

    Application.Union(Range("A1", Range("A1").End(xlDown)), Range("B1", Range("B1").End(xlDown)), Range("C1", Range("C1").End(xlDown)), Range("D1", Range("D1").End(xlDown)), Range("E1", Range("E1").End(xlDown))).Select
    Selection.Copy
        
        Workbooks(MyResultados).Activate    'pegado de información
            Worksheets("Ip's_Glovo").Activate
                Range("A1").Activate
                    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
            
        Worksheets("Ip's_Glovo").Activate   'para volver a la hoja de resultados
        
        Application.DisplayAlerts = False   'para que no salte cuadro de diálogo de clipboard
        
        Workbooks(MyInfo).Close savechanges:=False  'cierro el libro de info
        
        
'sheets de usuarios
        
        
    MyResultados = ThisWorkbook.Name
    
    'InfoPath = Application.GetOpenFilename    'display para abrir libro de info
        'Workbooks.Open Filename:=InfoPath     'abro el libro
    Workbooks.Open Filename:=("C:\Users\72764546\Downloads\List for Access Management - Dynamicall.xlsx")
        
    MyInfo = ActiveWorkbook.Name

        
    
        Worksheets("Hired users - Dynamicall").Select           'copiando información
            Range("B15:AD5000").Select

                
        'Data = Range("B" & Cells.Rows.Count).End(xlUp).Row
        'Range("B15:B" & Data).Select
        Selection.Copy
                
        Workbooks(MyResultados).Activate    'pegado de información
        Worksheets.Add(After:=Worksheets("Ip's_Glovo")).Name = "Glovo-Dynamicall"
            Worksheets("Glovo-Dynamicall").Activate
                Range("A1").Activate
                    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
            
        Worksheets("Glovo-Dynamicall").Activate   'para volver a la hoja de resultados
        
        Application.DisplayAlerts = False   'para que no salte cuadro de diálogo de clipboard
        
        Workbooks(MyInfo).Close savechanges:=False  'cierro el libro de info
        
    
    '############# SEGUNDO LIBRO #############
    
    MyResultados = ThisWorkbook.Name
    
    'InfoPath = Application.GetOpenFilename    'display para abrir libro de info
        'Workbooks.Open Filename:=InfoPath     'abro el libro
    Workbooks.Open Filename:=("C:\Users\72764546\Downloads\List for Access Management - Dynamicall Spain.xlsx")
    MyInfo = ActiveWorkbook.Name
    
    
        Worksheets("Hired users - Dynamicall").Select           'copiando información
            Range("B16:AD5000").Select
        Selection.Copy
                
        Workbooks(MyResultados).Activate    'pegado de información
            Worksheets("Glovo-Dynamicall").Activate
                Range("A1").End(xlDown).Offset(1, 0).Select
                    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
            
        Worksheets("Glovo-Dynamicall").Activate   'para volver a la hoja de resultados
        
        Application.DisplayAlerts = False   'para que no salte cuadro de diálogo de clipboard
        
        Workbooks(MyInfo).Close savechanges:=False  'cierro el libro de info
        
    Cells.Select
    Cells.EntireColumn.AutoFit
    Range("A1").Select
        
        
        
'TOMA


MyResultados = ThisWorkbook.Name

    Workbooks.Open Filename:=("C:\Users\72764546\Downloads\Programación GLOVO.xlsx")
        
    MyInfo = ActiveWorkbook.Name

    Application.Union(Range("E1", Range("E1").End(xlDown)), Range("F1", Range("F1").End(xlDown)), Range("G1", Range("G1").End(xlDown)), Range("H1", Range("H1").End(xlDown)), Range("I1", Range("I1").End(xlDown)), Range("J1", Range("J1").End(xlDown)), Range("K1", Range("K1").End(xlDown)), Range("L1", Range("L1").End(xlDown)), Range("M1", Range("M1").End(xlDown)), Range("N1", Range("N1").End(xlDown)), Range("O1", Range("O1").End(xlDown)), Range("P1", Range("P1").End(xlDown)), Range("Q1", Range("Q1").End(xlDown)), Range("R1", Range("R1").End(xlDown))).Select
    Selection.Copy
        
        Workbooks(MyResultados).Activate    'pegado de información
        Worksheets.Add(After:=Worksheets("Glovo-Dynamicall")).Name = "Progra"
            Worksheets("Progra").Activate
                Range("A1").Activate
                    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
        Cells.Select
        Cells.EntireColumn.AutoFit
        Range("A1").Select
            
        Worksheets("Ip's_Glovo").Activate   'para volver a la hoja de resultados
        
        Application.DisplayAlerts = False   'para que no salte cuadro de diálogo de clipboard
        
        Workbooks(MyInfo).Close savechanges:=False  'cierro el libro de info
        
    Cells.Select
    Cells.EntireColumn.AutoFit
    Range("A1").Select


'Formato de número
        
        Worksheets("Ip's_Glovo").Activate
        rango = Range("A:A")
        Range("A:A").Value = rango
        
        Call FiltroDni
        
        'Traslado de Data
        
        Worksheets.Add.Name = "Ip's Glovo"
        Worksheets("Ip's_Glovo").Select
        
        Application.Union(Range("A1", Range("A1").End(xlDown)), Range("B1", Range("B1").End(xlDown)), Range("C1", Range("C1").End(xlDown)), Range("D1", Range("D1").End(xlDown)), Range("E1", Range("E1").End(xlDown))).Select
        Selection.Copy
        
        Worksheets("Ip's Glovo").Activate
        Range("A1").Activate
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
        Call TrasladoInfo
        
    
        Worksheets("Ip's_Glovo").Select
        Cells.Select
        Cells.EntireColumn.AutoFit
        Range("A1").Select
        
                Sheets("Ip's Glovo").Select
                ActiveWindow.SelectedSheets.Delete
                
        Call Encabezados
                
        Call BuscarData
        Call Letra
        
        
    Rows("1:1").Select
    Selection.AutoFilter
    Range("A1").Select
    ActiveSheet.Range("$A:$J").AutoFilter Field:=7, Criteria1:="#N/A"

    ultLinea = Sheets("Ip's_Glovo").Range("A" & Rows.Count).End(xlUp).Row

    Rows("2:2").Select
    Range(Selection, Selection.End(xlDown)).Select
    Rows("2:5000").Select
    Selection.Delete Shift:=xlUp
    Selection.End(xlToLeft).Select
    Selection.End(xlUp).Select
    Selection.End(xlToLeft).Select
    Selection.End(xlUp).Select
    Selection.AutoFilter

                
        Cells.Select
        Cells.EntireColumn.AutoFit
        Range("A1").Select
        ActiveWorkbook.Save 'Guardar libro

End Sub
